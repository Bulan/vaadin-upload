{"version":3,"sources":["vaadin-upload.ts"],"names":[],"mappings":"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","file":"vaadin-upload.js","sourcesContent":["import {\n  Directive,\n  ElementRef,\n  Output,\n  HostListener,\n  EventEmitter\n} from '@angular/core';\ndeclare var Polymer;\n\n@Directive({\n  selector: 'vaadin-upload'\n})\nexport class VaadinUpload {\n\n  private _element;\n  private _initialValueSet = false;\n\n  @Output() filesChange: EventEmitter<any> = new EventEmitter(false);\n  @HostListener('files-changed')\n  fileschanged() {\n    if (!this._initialValueSet) {\n      this._initialValueSet = true;\n      return;\n    }\n\n    this.filesChange.emit(this._element.files);\n  }\n\n  constructor(el: ElementRef) {\n    if (!(<any>window).Polymer || !Polymer.isInstance(el.nativeElement)) {\n      console.error(\"vaadin-upload has not been imported yet, please remember to import vaadin-upload.html in your main HTML page.\");\n      return;\n    }\n\n    this._element = el.nativeElement;\n\n    if (!Polymer.Settings.useShadow) {\n      this._element.async(this._observeMutations.bind(this));\n    }\n  }\n\n  _observeMutations() {\n    const lightDom = Polymer.dom(this._element);\n    const observerConfig = { childList: true, subtree: true };\n\n    // Move all the misplaced nodes to light dom\n    [].slice.call(this._element.childNodes, 0).forEach((child) => {\n      if (this._isLightDomChild(child)) {\n        lightDom.appendChild(child);\n      }\n    });\n\n    // Add a mutation observer for further additions / removals\n    const observer = new MutationObserver((mutations) => {\n      observer.disconnect();\n\n      mutations.forEach((mutation) => {\n        [].forEach.call(mutation.addedNodes, (added) => {\n          if (this._isLightDomChild(added) && added.parentElement === this._element) {\n            lightDom.appendChild(added);\n          }\n        });\n\n        [].forEach.call(mutation.removedNodes, (removed) => {\n          if (lightDom.children.indexOf(removed) > -1) {\n            lightDom.removeChild(removed);\n          }\n        });\n      });\n\n      setTimeout(() => {\n        observer.observe(this._element, observerConfig);\n      }, 0);\n    });\n\n    observer.observe(this._element, observerConfig);\n  }\n\n  _isLightDomChild(node) {\n    return !node.tagName || !node.classList.contains('vaadin-upload');\n  }\n}\n"],"sourceRoot":"/source/"}